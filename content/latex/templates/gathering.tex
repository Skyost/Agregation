\input{common}
\input{bibliography}

% Nouveaux paquets :

\usepackage{xstring}
\usepackage{catchfile}

% Table des matières :

\setcounter{tocdepth}{1}

% Nouvelles commandes :

\CatchFileDef{\headfull}{../../.git/HEAD.}{}
\StrGobbleRight{\headfull}{1}[\head]
\StrBehind[2]{\head}{/}[\branch]
\IfFileExists{../../.git/refs/heads/\branch.}{%
	\CatchFileDef{\commit}{../../.git/refs/heads/\branch.}{}}{%
	\newcommand{\commit}{%
		\dots~(in \emph{packed-refs})%
	}%
}

\newcommand{\gatheringtitle}{%s}

\makeatletter
\newcommand\inputcontent{\@ifstar{\inputcontent@star}{\inputcontent@nostar}}
\newcommand{\inputcontent@star}[1]{%
	\ExecuteMetaData[#1]{content}%
}
\newcommand{\inputcontent@nostar}[1]{%
	\newpage%
	\inputcontent@star{#1}%
}
\makeatother

\newcommand{\gathering}[1]{%
	{\title{#1}\chapter{#1}}%
	\thispagestyle{fancy}%
}

\newcommand{\resetsectioncount}{\setcounter{section}{0}}

% Redéfinition des commandes :

\renewcommand{\lesson}[3]{%
	\setcounter{section}{\numexpr #2 - 1}%
	\section{#3}%
	\label{#2}
	\fancyhead[R]{\truncate{0.73\textwidth}{#2 : #3}}%
}

\renewcommand{\development}[3]{%
	\resetsectioncount%
	\renewcommand{\resetsectioncount}{}
	\section{#3}%
	\label{#2}
	\fancyhead[R]{\truncate{0.73\textwidth}{#3}}%
}

% Premières pages :

\AtBeginDocument{
	\hypersetup{pdftitle={\gatheringtitle}}%
	\thispagestyle{empty}%
 	\clearpage%
 	\vspace*{\fill}%
	\begin{center}%
		{\huge\bfseries Agrégation 2024}%

		\smallskip%
		\gatheringtitle%
	\end{center}%
	\vfill%
	\clearpage%
	{%
		\thispagestyle{empty}%
		{%
			\vspace*{\fill}%
			\begin{center}%
				Document intégralement écrit par Hugo Delaunay.

				Visitez \href{https://agreg.skyost.eu}{\texttt{agreg.skyost.eu}} pour plus de ressources et d'informations.

				\bigskip

				{\footnotesize \textit{Une coquille ? Une correction à apporter ?} Rendez-vous sur le dépôt Github ``\href{https://github.com/Skyost/Agregation}{\texttt{Skyost/Agregation}}'' ou contactez-moi via mon site web personnel \href{https://skyost.eu/fr/\#contact}{\texttt{skyost.eu}}.}
				
				\bigskip
				
				{\tiny \texttt{\#\commit}}
			\end{center}%
			\vfill%
		}%
	}%
	\newpage%
	{%
		\pagestyle{empty}%
		\fancypagestyle{plain}%
		{%
			\fancyhf{}%
			\renewcommand{\headrulewidth}{0pt}%
			\renewcommand{\footrulewidth}{0pt}%
		}%
		\tableofcontents%
		\thispagestyle{empty}%
	}%
	\newpage%
	\setcounter{page}{1}%
}

% Bibliographie :

\setbibliographypath{bibliographie}

%s

\begin{document}

%s

\end{document}
